story_id,epic,title,user_role,description,priority,story_points,dependencies,acceptance_criteria_1,acceptance_criteria_2,acceptance_criteria_3,technical_tasks,definition_of_done
"US-001","Core Architecture & Project Setup","Establish Project Foundation","Developer","As a Developer, I want a well-defined solution structure with dependency injection configured so that I can build features in a maintainable and scalable way.","Must Have","5","","Given the solution is opened in an IDE, When the projects are built, Then the build succeeds without errors and all project references are correctly resolved.","Given the WPF client or Windows Service is starting, When the application requests a registered service from the DI container, Then an instance of the service is successfully provided.","Given a new feature needs to be added, When a developer follows the Clean Architecture pattern, Then there is a clear project layer (Core, Application, Infrastructure) for the new code to reside in.","WI-001: Create Solution and Project Structure, WI-002: Setup Dependency Injection","Code is peer-reviewed and merged into the main branch. Solution structure is approved by the tech lead. DI is configured and a sample service can be resolved in both client and service applications. Unit test projects are set up."
"US-002","Core Architecture & Project Setup","Implement System-Wide Structured Logging","Administrator","As an Administrator, I want the system to generate detailed logs for both client and service operations, with sensitive patient data masked, so that I can effectively troubleshoot issues while maintaining HIPAA compliance.","Must Have","8","US-001","Given the system is running, When an action (e.g., user login, file import) is performed, Then a corresponding log entry is written to both the rolling text file and the Windows Event Log.","Given a log entry is generated that involves patient data, When I inspect the log file or Event Log, Then I see placeholders like '[REDACTED]' instead of actual Patient Names or IDs.","Given I am troubleshooting an issue, When I review the logs, Then I can clearly distinguish between events originating from the WPF Client and the background Windows Service.","WI-003: Implement Serilog for Structured Logging","Logging is implemented in both client and service. Log sinks for File and Event Log are functional. A custom Serilog enricher correctly redacts PHI based on property names. All log entries contain sufficient context for troubleshooting."
"US-003","Core Architecture & Project Setup","Provide Real-time Service Status Feedback","System User","As a System User, I want the client application to know if the background service is running so that I am prevented from starting tasks that will fail and receive clear feedback about the system's status.","Should Have","5","US-001","Given the background Windows Service is running, When the client application starts or checks the status, Then UI elements dependent on the service (e.g., 'Print' button) are enabled.","Given the background Windows Service is stopped, When the client application starts or checks the status, Then UI elements dependent on the service are disabled and a notification indicates the service is unavailable.","Given the background service stops while the client is running, When the user attempts an action requiring the service, Then the action is prevented and a user-friendly error message is displayed promptly.","WI-004: Implement Named Pipe Server in Windows Service, WI-005: Implement Named Pipe Client in WPF Application","Named Pipe server in the service and client in the WPF app are implemented. The client's `IsServiceRunningAsync` method correctly returns true or false based on the service state. UI controls correctly bind to the status check result."
"US-004","Core Architecture & Project Setup","Enable Asynchronous Background Task Processing","System User","As a System User, I want the application to remain responsive while performing long-running tasks like printing or importing, so that I can continue my work without interruption.","Must Have","8","US-001","Given a long-running task like printing is initiated from the UI, When the task is submitted, Then the UI remains immediately responsive and does not freeze.","Given the RabbitMQ server restarts while a task is in the queue, When the server comes back online, Then the task is not lost and is eventually processed by the background service.","Given a background task fails processing after multiple retries, When I check the system health dashboard or logs, Then I can see that the failed task has been moved to a dead-letter queue for manual inspection.","WI-006: Implement RabbitMQ Publisher (Client) and Consumer (Service)","RabbitMQ publisher is integrated into the client and a consumer host is running in the service. Queues are declared as durable and messages as persistent. A Dead-Letter Exchange (DLX) is configured and tested to catch poison messages."
"US-005","User Authentication & Authorization","Log In to the Application","Registered System User","As a Registered System User, I want to securely log in to the application using my username and password so that I can gain access to system features authorized for my role.","Must Have","8","US-001","Given I have valid and active user credentials, When I enter them on the login screen and click 'Login', Then I am granted access and the main application window is displayed.","Given I enter my correct username but an incorrect password, When I click 'Login', Then a generic 'Invalid username or password.' error is displayed, and I remain on the login screen.","Given I attempt to log in with credentials for a disabled account, When I click 'Login', Then an error message 'Your account has been disabled...' is displayed, and access is denied.","WI-007: Define User, Role, and PasswordHistory EF Core Entities, WI-008: Create Initial EF Core Migration for User Schema, WI-009: Implement BCrypt Password Hashing Service, WI-010: Implement User Login Service and WPF ViewModel","Login UI and ViewModel are complete. Authentication service correctly validates credentials against BCrypt hashes stored in the database. The system handles incorrect passwords, non-existent users, and disabled accounts gracefully. Passwords are never logged in plaintext."
"US-006","User Authentication & Authorization","Restrict Feature Access Based on User Role","System User","As a System User, I want the application's features to be enabled or disabled based on my assigned role so that I only see and can use the functions I am authorized for.","Must Have","8","US-005","Given I am logged in as a 'Technician', When I navigate the application, Then the 'Administration' section and the 'Edit DICOM Metadata' button are hidden or disabled.","Given I am logged in as an 'Administrator', When I navigate the application, Then all features, including the 'Administration' section and 'Edit DICOM Metadata' button, are visible and enabled.","Given a user attempts to access an admin-only feature programmatically (bypassing the UI), When the action is invoked, Then the request is rejected by the application's business logic layer with an authorization error.","WI-011: Implement Role-Based UI Control","A centralized session context service is available to all ViewModels. UI elements correctly use this context to control their visibility and enabled states. Backend service methods are decorated with authorization attributes to prevent unauthorized access."
"US-007","User Authentication & Authorization","Automatically Lock Session Due to Inactivity","System User","As a System User, I want the application to automatically lock after 15 minutes of inactivity so that sensitive patient information is protected if I step away from my workstation.","Must Have","8","US-005","Given I am logged into the application, When I do not interact with the application via mouse or keyboard for 15 minutes, Then a modal lock screen overlay appears, obscuring the application.","Given my session is locked, When I enter my correct password and click 'Unlock', Then the lock screen disappears and I can resume my work exactly where I left off.","Given my session is locked, When I enter an incorrect password, Then an error message is displayed, and the session remains locked.","WI-012: Implement Automatic Session Lock","An application-wide inactivity monitor is implemented with low performance overhead. The lock screen overlay correctly covers all UI and preserves the application state. The unlock mechanism correctly validates the user's password."
"US-008","System Administration","Admin Creates New User Account","Administrator","As an Administrator, I want to create a new user account with a username, role, and temporary password so that I can provision system access for new staff members.","Must Have","8","US-006, US-012","Given I am on the 'User Management' page, When I fill out the 'Add User' form with a unique username and select a role, and click 'Create', Then the user is created, and I am shown a secure temporary password for the new user.","Given the new user logs in for the first time with the temporary password, When they successfully authenticate, Then they are immediately forced to create a new, permanent password.","Given I have created a new user, When I view the Audit Trail, Then I see a log entry for the 'User Created' event, including my username and the new user's username.","WI-013: Create User Management View and ViewModel, WI-014: Implement 'Create User' Functionality","The User Management UI allows adding users. The backend service creates the user, generates and hashes a temporary password, sets the 'force password change' flag, and writes an audit log entry within a single atomic database transaction."
"US-009","System Administration","Admin Manages User Roles and Status","Administrator","As an Administrator, I want to edit an existing user's role or disable their account so that I can manage user permissions and revoke access when necessary.","Must Have","5","US-006, US-012","Given I am on the 'User Management' page, When I select a user, change their role from 'Technician' to 'Administrator', and save, Then the user's permissions are updated for their next session, and the change is audited.","Given I am on the 'User Management' page, When I select a user and set their account status to 'Disabled', Then that user is immediately unable to log in to the system.","Given I attempt to disable or demote the last remaining Administrator account, When I try to save the change, Then the system prevents the action and displays an error message explaining that at least one administrator must exist.","WI-015: Implement 'Edit User' Functionality","The User Management UI allows editing users via a modal dialog. The backend service validates against demoting/disabling the last admin. All changes to role or status are recorded in the audit trail."
"US-010","System Administration","Admin Deletes User Account","Administrator","As an Administrator, I want to permanently delete a user account so that I can completely revoke access for personnel who have left the organization.","Should Have","3","US-006, US-012","Given I am on the 'User Management' page, When I select a user, click 'Delete', and confirm the action, Then the user account is permanently removed from the system.","Given I have deleted a user, When I check the Audit Trail, Then I see a log entry for the 'User Deleted' event with the relevant details.","Given I am viewing the user list, When I locate my own user account, Then the 'Delete' button for my own account is disabled, preventing self-deletion.","WI-013: Create User Management View and ViewModel (Delete command)","The User Management UI provides a delete function with a confirmation dialog. The backend service prevents self-deletion and the deletion of the last admin. The user record deletion and audit log creation are atomic."
"US-011","System Administration","Admin Resets User Password","Administrator","As an Administrator, I want to reset a user's password so that I can restore their access if they have forgotten their credentials.","Must Have","5","US-006, US-012","Given I am on the 'User Management' page, When I select a user and click 'Reset Password', Then the system generates a new temporary password and displays it to me.","Given a user's password has been reset, When they log in with the new temporary password, Then they are immediately forced to set a new permanent password.","Given I have reset a user's password, When I view the Audit Trail, Then I see a log entry for the 'Password Reset' event, including my username and the target user's username.","WI-016: Implement 'Password Reset' Functionality","The User Management UI provides a password reset function. The backend service generates a temporary password, updates the user's hash, sets the 'force password change' flag, and creates an audit log entry in a single transaction."
"US-012","System Administration","Admin Reviews Audit Trail","Administrator","As an Administrator, I want to view a comprehensive audit trail of significant system events so that I can monitor for security compliance and investigate incidents.","Must Have","8","US-001, US-006","Given I am on the 'Audit Trail' page, When the view loads, Then I see a time-stamped list of all significant events, such as user logins, password changes, and data modifications.","Given the audit trail contains many entries, When I use the filter controls to specify a date range and a user, Then the list updates to show only the events that match my criteria.","Given I have filtered the audit trail view, When I click the 'Export to CSV' button, Then a CSV file is generated containing the currently displayed log data.","WI-017: Define AuditLog EF Core Entity and Migration, WI-018: Implement Audit Logging Service, WI-019: Create Audit Trail Viewer UI","An Admin-only UI for viewing audit logs is implemented. The ViewModel supports filtering by user and date. An export function generates a CSV file of the filtered results. All data is fetched efficiently from the database."
"US-013","System Administration","Admin Monitors System Health","Administrator","As an Administrator, I want to view a real-time dashboard of system health so that I can proactively identify and address potential issues with the application and its dependencies.","Should Have","8","US-003, US-004, US-006","Given I am on the 'System Health Dashboard', When the view loads, Then I see status indicators for the Windows Service, PostgreSQL connection, and RabbitMQ connection.","Given the dashboard is open, When a connection to a dependency is lost, Then the corresponding status indicator changes from green to red in near real-time.","Given the dashboard is open, When I view the queue status, Then I can see the current number of messages in the main processing queue and the dead-letter queue.","WI-020: Implement System Health Dashboard","An Admin-only dashboard UI is created. It polls for health data from the background service via a secure IPC mechanism. The dashboard displays the status of all critical components and includes configurable warning thresholds for metrics like disk space."
"US-014","DICOM Core Functionality","Automatically Receive and Process Incoming DICOM Studies","Technician","As a Technician, I want the system to automatically listen for and receive studies sent from our imaging modalities (e.g., CT, X-Ray) so that they are ingested into the application without manual intervention.","Must Have","13","US-004","Given a DICOM modality sends a study to the system's AE Title and port, When the transfer is complete, Then the study's metadata is recorded in the database and the files are stored in the configured local storage path.","Given the system receives studies at a high rate, When multiple modalities are sending simultaneously, Then the system remains stable, queues the processing, and does not lose any data.","Given a study is received, When its metadata is written to the database, Then the DICOM files are moved from a temporary location to a permanent, structured folder path (e.g., ...\\[PatientID]\\[StudyInstanceUID]).","WI-021: Implement DICOM C-STORE SCP Listener in Windows Service, WI-022: Implement DICOM Metadata Persistence from Queue, WI-024: Define DICOM Data EF Core Entities and Migrations","A C-STORE SCP is implemented in the Windows Service using `fo-dicom`. It decouples reception from persistence by publishing metadata to a RabbitMQ queue. A separate consumer processes these messages, writes to the PostgreSQL DB, and moves files."
"US-015","DICOM Core Functionality","Query and Retrieve Studies from a Remote PACS","Technician","As a Technician, I want to search for studies on our central PACS and retrieve them to my local system so that I can perform viewing or printing tasks on prior examinations.","Must Have","8","US-014","Given I have configured a remote PACS, When I enter search criteria (e.g., Patient ID) and execute a search, Then a list of matching studies from the remote PACS is displayed in the UI.","Given search results are displayed, When I select one or more studies and click 'Retrieve', Then the system initiates a DICOM C-MOVE request to transfer the studies to my local application.","Given a C-MOVE retrieval is in progress, When I view the UI, Then I can see real-time feedback on the operation's status, including progress and any potential errors.","WI-023: Implement C-FIND/C-MOVE SCU in WPF Client","A WPF UI is created for querying remote PACS. The application acts as a C-FIND and C-MOVE SCU using `fo-dicom`. All network operations are asynchronous, and the UI provides clear feedback to the user during the retrieval process."
"US-016","DICOM Core Functionality","Browse and Search for Local DICOM Studies","System User","As a System User, I want to browse a list of all locally stored studies and search for specific ones so that I can quickly find the examination I need to work with.","Must Have","8","US-014","Given studies have been imported into the system, When I open the 'Study Browser', Then I see a list of all available studies.","Given I am in the 'Study Browser', When I type a patient's name into the search bar, Then the list is filtered to show only studies matching that patient.","Given the database contains a large number of studies, When I perform a search, Then the results are returned quickly and the UI remains responsive.","WI-025: Implement Local Study Browser and Search","A main UI view is created to browse and search studies stored locally. The ViewModel translates user search criteria into efficient Entity Framework Core queries against the PostgreSQL database."
"US-017","DICOM Core Functionality","Import DICOM Studies via Drag-and-Drop","System User","As a System User, I want to import DICOM studies from a CD or local folder by dragging them into the application so that I can easily add external studies to the system.","Should Have","8","US-003, US-004, US-014","Given I drag a folder containing DICOM files onto the main application window, When I drop the folder, Then an import process is initiated for the studies within.","Given I try to import a study that already exists in the system, When the duplicate is detected, Then a dialog appears prompting me to 'Overwrite', 'Discard', or 'Save as New'.","Given the import process may take time, When I initiate an import, Then the UI remains responsive, and I receive a notification that the import has been queued for background processing.","WI-026: Implement Drag-and-Drop DICOM Import","Drag-and-drop is enabled on the main WPF window. The import process uses a synchronous Named Pipe call to check for duplicates before publishing an import job to RabbitMQ for asynchronous processing by the background service."
"US-018","DICOM Viewer Implementation","View DICOM Images in a High-Performance Viewer","System User","As a System User, I want to open a study and view its images in a fast, responsive viewer so that I can efficiently review medical images.","Must Have","13","US-016","Given I double-click a study in the study browser, When the viewer opens, Then the images of the first series are displayed.","Given a large multi-frame series (e.g., CT) is opened, When the viewer loads, Then a low-resolution preview appears almost instantly, while the full-resolution data loads in the background.","Given I have two series open in comparison mode, When I enable synchronization and pan one image, Then the other image pans in unison.","WI-027: Implement GPU-Accelerated Rendering Pipeline, WI-028: Develop Viewer Layout and Comparison Mode","A WPF viewer control is built using DirectX interop (`Vortice.Windows`) for GPU-accelerated rendering. The viewer supports progressive loading, a thumbnail panel for navigation, and a synchronized side-by-side comparison mode."
"US-019","DICOM Viewer Implementation","Manipulate Images with Standard Viewer Tools","System User","As a System User, I want to use standard tools like zoom, pan, and window/level so that I can adjust the image display for optimal viewing.","Must Have","8","US-018","Given an image is open in the viewer, When I use the mouse scroll wheel, Then the image zooms in and out smoothly.","Given an image is open, When I right-click and drag the mouse, Then I can adjust the window width and level (WW/WL) interactively.","Given a CT image is open, When I select a 'Lung' window preset from a dropdown, Then the WW/WL values are automatically applied to the image, optimizing it for viewing lung tissue.","WI-029: Implement Standard Image Manipulation Tools","Interactive tools for zoom, pan, rotate, flip, and WW/WL are implemented. User mouse input is captured by the viewer control and translated into manipulations of the DirectX rendering pipeline. Common WW/WL presets are available."
"US-020","DICOM Viewer Implementation","Create and Save Annotations and Measurements","Technician","As a Technician, I want to draw annotations and take measurements on an image and save them for later review so that I can highlight findings and record key metrics.","Should Have","13","US-019","Given an image is open in the viewer, When I select the 'length' measurement tool and draw a line, Then the line is displayed on the image along with its length in millimeters.","Given I have added several annotations to a study, When I click 'Save Annotations', Then a new DICOM Grayscale Softcopy Presentation State (GSPS) object is created and associated with the series.","Given I reopen a study that has saved annotations, When the image loads, Then the previously saved annotations are automatically displayed on the image.","WI-030: Implement Annotation and Measurement Tools","The viewer supports drawing graphic overlays for annotations and measurements. A 'Save' function uses `fo-dicom` to construct and save a GSPS object. The viewer can parse and render existing GSPS objects for a series."
"US-021","Printing & Exporting","Print DICOM Images with Custom Layouts","Technician","As a Technician, I want to print DICOM images on a standard office printer with flexible layout options so that I can create physical copies for reference or patient records.","Must Have","8","US-003, US-004","Given I have selected images to print, When I open the Print Preview, Then I can select a layout template, such as '2x2 grid on A4', and see the result.","Given the background print service is not running, When I view the application, Then the 'Print' button is disabled.","Given I have finalized my layout and clicked 'Print', Then the print job is sent to the background service for processing, and my client application remains responsive.","WI-031: Implement Print Job Submission Logic, WI-032: Implement Print Job Consumer in Windows Service","The client-side print workflow first checks service status via Named Pipe, then submits a serialized print job to a RabbitMQ queue. The background service consumes this job and uses the Windows Print API to spool it to the selected printer."
"US-022","Printing & Exporting","Manage and Monitor Print Jobs","System User","As a System User, I want to see the status of my print jobs in a queue so that I know if my print was successful or if it failed.","Should Have","8","US-021","Given I have submitted a print job, When I open the 'Print Queue' view, Then I can see my job listed with a status of 'Queued' or 'Processing'.","Given a print job fails due to the printer being offline, When I view the job in the queue, Then its status is 'Failed' and the reason 'Printer is offline' is displayed.","Given I am an Administrator viewing the Print Queue, When I see multiple jobs, Then I can change the priority of a queued job to make it print sooner.","WI-033: Implement Print Queue UI","A WPF view is created to display print jobs and their statuses from the database. The UI provides options for users to cancel their own jobs and for admins to manage all jobs. The view must receive or poll for status updates."
"US-023","Printing & Exporting","Export Print Layout as a Secure PDF","System User","As a System User, I want to export my print layout as a password-protected PDF file so that I can create a secure digital copy for electronic sharing or archiving.","Should Have","8","US-021","Given I have arranged a layout in the Print Preview, When I click 'Export to PDF', Then I am prompted to choose a file location and an optional password.","Given I choose to export with a password, When the PDF is generated, Then it is encrypted using AES-256 and cannot be opened without the password.","Given the system requirements, When the PDF is generated, Then it must be compliant with the PDF/A-3 standard for long-term archiving.","WI-034: Implement PDF/A-3 Export with QuestPDF","PDF generation is handled as an asynchronous background task. A service uses the QuestPDF library to create the document, ensuring PDF/A-3 compliance and supporting AES-256 encryption options as specified."
"US-024","Printing & Exporting","Send Print Output via Email","System User","As a System User, I want to send the print output via email directly from the application so that I can easily share it with colleagues or referring physicians.","Could Have","8","US-023","Given I am an Administrator, When I go to the Settings page, Then I can configure the SMTP server settings required for sending emails.","Given I am in the Print Preview, When I choose to 'Send via Email', Then a dialog appears allowing me to compose an email, with the print output automatically attached as a PDF.","Given I am sending an email containing patient information without password-protecting the attachment, When I click 'Send', Then a prominent warning dialog appears informing me of the risks of sending unsecured PHI and requires explicit confirmation.","WI-035: Implement Email Sending Functionality","An admin UI for SMTP configuration is created. An email composition dialog is available to users. A background service handles the actual email sending. Logic is implemented to display a security warning when sending potentially unsecured PHI."
"US-025","Deployment & Installation","Install and Configure the Application","Administrator","As an Administrator, I want a simple installer that bundles all application components and verifies prerequisites so that I can deploy the system reliably.","Must Have","8","US-001","Given I run the MSIX installer, When the installation completes, Then the WPF client application is installed, and the 'DICOM Service' Windows Service is registered and started.","Given I am running the installer or the application for the first time, When prompted for database and message queue connection details, Then the system validates connectivity before allowing me to proceed.","Given the PostgreSQL database is missing the `pgcrypto` extension, When the prerequisite check runs, Then the check fails and displays an error message indicating the required extension is missing.","WI-036: Configure MSIX Packaging Project, WI-037: Implement Installer Prerequisite Checks","A Visual Studio Packaging Project is configured to create a signed MSIX installer. The installer manifest is configured to register and start the Windows Service. A first-run check within the WPF app validates connectivity to dependencies."
"US-026","Deployment & Installation","Access Comprehensive System Documentation","Administrator","As an Administrator, I want access to clear Deployment and Administrator's Guides so that I can correctly install, configure, and manage the system.","Should Have","5","US-025","Given I am responsible for deploying the system, When I read the Deployment Guide, Then I have all the necessary steps to configure prerequisites and run the installer.","Given I am managing a live system, When I read the Administrator's Guide, Then I can find instructions for all administrative tasks, such as user management and database backup.","Given a disaster occurs, When I follow the database restore procedure in the Administrator's Guide, Then I can successfully restore the database from a backup file.","WI-038: Write Deployment Guide, WI-039: Write Administrator's Guide","Two PDF documents are created: a Deployment Guide covering installation and a comprehensive Administrator's Guide covering all system management tasks, including detailed backup and restore procedures using standard tools like `pg_dump`."