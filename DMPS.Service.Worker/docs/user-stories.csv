story_id,epic,title,user_role,description,priority,story_points,dependencies,acceptance_criteria_1,acceptance_criteria_2,acceptance_criteria_3,technical_tasks,definition_of_done
"US-001","Core Architecture, Configuration, and Setup","Establish Core Application Framework","Developer / System Administrator","As a Developer, I want a well-structured solution with dependency injection and robust logging so that I can build features efficiently and troubleshoot issues effectively.","Must Have",8,"","Given the .NET 8 SDK is installed, When the solution is opened and built, Then all projects compile successfully without errors.","Given the application (WPF Client or Windows Service) is started, When a service is requested from the DI container, Then the correct service instance is resolved and provided.","Given the application is running and an action is performed, When the action logs a message containing Protected Health Information (e.g., Patient Name), Then the message is written to both the rolling file and the Windows Event Log with the PHI data redacted.","WI-001, WI-002, WI-003","Solution and all projects are scaffolded according to Clean Architecture. Dependency Injection is configured in both WPF and Service hosts. Serilog is integrated with sinks for rolling file and Windows Event Log, including a PHI redaction filter. All foundational code is peer-reviewed and merged to the main branch."
"US-002","Database and Persistence Layer","Set Up Database and Persistence Layer","Developer","As a Developer, I want a fully configured data persistence layer using Entity Framework Core and PostgreSQL so that the application can reliably store and retrieve data in a secure manner.","Must Have",13,"US-001","Given a blank PostgreSQL database, When the EF Core 'database update' command is run, Then the complete application schema, including tables, relationships, and constraints, is created successfully.","Given the application is configured to connect to a TLS-enabled PostgreSQL server, When the application starts, Then it successfully establishes a secure connection to the database.","Given a record with a PHI field (e.g., PatientName) is saved to the database, When the database table is inspected directly, Then the value in the PHI column is shown as an encrypted string.","WI-007, WI-008, WI-009, WI-010","All EF Core entities are defined as C# classes. The DbContext is configured with all relationships. The initial database migration is generated and successfully creates the schema. The PostgreSQL connection is configured to require TLS and use pgcrypto for PHI columns. The Repository pattern is implemented for key data aggregates."
"US-003","Core Architecture, Configuration, and Setup","Establish Inter-Process Communication (IPC) Channels","Developer","As a Developer, I want robust asynchronous and synchronous communication channels between the client and service so that the UI remains responsive and long-running tasks are handled reliably.","Must Have",8,"US-001","Given the client application sends a message via the RabbitMQ abstraction, When the Windows Service is running, Then the service consumes and correctly deserializes the message.","Given a message is rejected by the service consumer after multiple failures, When the RabbitMQ DLQ is inspected, Then the failed message is present in the dead-letter queue.","Given the WPF client needs to check the service status, When it sends a 'PING' request via Named Pipes, Then it receives a 'PONG' response within the configured timeout period.","WI-004, WI-005, WI-006","An abstraction for RabbitMQ is implemented, supporting persistent messages and durable queues. RabbitMQ topology (queues, exchanges, DLX/DLQ) is declared on service startup. A Named Pipe client/server is implemented for synchronous status checks between the WPF client and the Windows Service."
"US-004","User Authentication, Authorization, and Management","Log in to the Application","Registered System User","As a Registered System User, I want to securely log in with my username and password so that I can access the application's features.","Must Have",8,"US-002","Given I am a registered user with a valid password, When I enter my correct credentials on the login screen and click 'Login', Then I am granted access and the main application window is displayed.","Given I am on the login screen, When I enter a correct username but an incorrect password, Then I see a generic ""Invalid username or password"" error message and the password field is cleared.","Given I am on the login screen, When I enter a username that does not exist, Then I see the same generic ""Invalid username or password"" error message to prevent user enumeration.","WI-011, WI-012","BCrypt password hashing utility is implemented. A WPF Login View and ViewModel are created. An Authentication Service validates credentials against the database using the repository and hashing utility. All acceptance criteria are met, and E2E tests for successful and failed logins are passing."
"US-005","User Authentication, Authorization, and Management","Access Features Based on Assigned Role","Registered System User","As a Registered System User, I want the application's features to be enabled or disabled based on my role so that I only see and use the functions I am authorized for.","Must Have",5,"US-004","Given I am logged in as a 'Technician', When I navigate the application, Then the 'Administration' area/button is hidden and inaccessible.","Given I am logged in as a 'Technician' and viewing a study, When I inspect the UI, Then the button to 'Edit DICOM Metadata' is disabled.","Given I am logged in as an 'Administrator', When I navigate the application, Then all UI elements, including the 'Administration' area and 'Edit DICOM Metadata' button, are visible and enabled.","WI-013","A singleton session service holds the authenticated user's context (ID, role). A centralized authorization mechanism is implemented. UI elements in the WPF application dynamically hide or disable themselves based on the current user's role. Backend service calls are also protected by role checks."
"US-006","User Authentication, Authorization, and Management","Automatically Lock and Unlock Inactive Session","Registered System User","As a Registered System User, I want the application to automatically lock after 15 minutes of inactivity so that sensitive patient data is protected on an unattended workstation.","Must Have",8,"US-004","Given I am logged in and have been inactive for 15 minutes, When the timer expires, Then a modal lock screen overlay appears, obscuring the application.","Given my session is locked, When I enter my correct password and click 'Unlock', Then the lock screen disappears and I can resume my work from the exact state I left it in.","Given my session is locked, When I enter an incorrect password, Then an error message is displayed, and the session remains locked.","WI-014","An application-wide service monitors user keyboard and mouse activity. After 15 minutes of inactivity, a modal lock screen is displayed. The user must re-enter their password to unlock the session. The application state is fully preserved behind the lock screen. Failed unlock attempts are logged."
"US-007","User Authentication, Authorization, and Management","Create a New User Account","Administrator","As an Administrator, I want to create new user accounts with specific roles so that I can provision system access for new personnel.","Must Have",5,"US-005, US-014","Given I am logged in as an Administrator and on the User Management screen, When I add a new user with a username and role, Then the system creates the account and displays a secure, temporary password for me to provide to the user.","Given a new user account has been created, When the user logs in for the first time with the temporary password, Then they are immediately forced to create a new, permanent password.","Given I have created a new user, When I check the audit trail, Then a 'User Created' event is logged with my username, the new user's name, and a timestamp.","WI-015, WI-016","An administration UI for user management is created. The 'Create User' workflow is implemented, including a modal dialog, unique username validation, secure temporary password generation, and setting a 'force password change' flag. The user creation event is atomically logged to the audit trail."
"US-008","User Authentication, Authorization, and Management","Configure System-Wide Password Policies","Administrator","As an Administrator, I want to configure and enforce password policies so that I can ensure all user accounts meet our organization's security standards.","Must Have",5,"US-005","Given I am an Administrator, When I navigate to the password policy settings, Then I can configure parameters such as minimum length, complexity requirements, and expiration period.","Given I have set a minimum password length of 12 characters, When a user tries to change their password to one with 11 characters, Then the change is rejected with a clear error message.","Given I have configured password history to remember the last 5 passwords, When a user tries to reuse one of their last 5 passwords, Then the change is rejected.","WI-017","A settings UI is created for Administrators to manage password policy parameters (length, complexity, history, expiration). A validation service is implemented to enforce these policies during any password change operation. Policy settings are persisted in the database."
"US-009","DICOM Functionality","Receive and Store DICOM Studies","System","As the System, I want to listen for and receive DICOM studies from imaging modalities so that new patient data can be ingested into the application.","Must Have",13,"US-002, US-003","Given the Windows Service is running, When an external modality sends a study via DICOM C-STORE, Then the service accepts the association, receives all files, and stores them locally.","Given a study has been successfully received via C-STORE, When the RabbitMQ queue is monitored, Then a new message containing the study's metadata is published to the ingestion queue.","Given a message is consumed from the ingestion queue, When the database is checked, Then the corresponding study metadata (Patient, Study, Series, etc.) has been inserted, and the DICOM files have been moved to permanent storage.","WI-018, WI-019","The Windows Service hosts a C-STORE SCP listener using fo-dicom. Upon receiving a study, it saves the files, parses the metadata, and publishes a message to a persistent RabbitMQ queue. A separate background consumer processes this message, writing metadata to PostgreSQL and moving files to their final destination."
"US-010","DICOM Functionality","Query and Retrieve Studies from a Remote PACS","Technician / Administrator","As a Technician, I want to query a remote PACS and retrieve selected studies so that I can import prior imaging for comparison or review.","Must Have",8,"US-009","Given I have configured a remote PACS, When I enter search criteria (e.g., Patient ID) and execute a search, Then a list of matching studies from the PACS is displayed in the UI.","Given a list of search results from a PACS is displayed, When I select one or more studies and click 'Retrieve', Then a DICOM C-MOVE request is initiated.","Given a C-MOVE request was successful, When I check the local study list, Then the retrieved studies are now available in the local system.","WI-020","The WPF client provides a UI for configuring remote PACS and performing C-FIND queries. The application service uses fo-dicom to send C-FIND requests. From the results, users can trigger a C-MOVE request, which instructs the remote PACS to send the studies to the application's local C-STORE SCP."
"US-011","DICOM Functionality","View and Manipulate DICOM Images","Technician / Administrator","As a Technician, I want a high-performance image viewer with standard manipulation tools so that I can effectively review and analyze medical images.","Must Have",21,"","Given I open a DICOM study, When the image is displayed, Then it is rendered using GPU acceleration for smooth performance.","Given an image is displayed in the viewer, When I use the mouse to adjust the window and level, Then the image brightness and contrast update interactively and in real-time.","Given an image is displayed, When I use the toolbar controls, Then I can successfully zoom, pan, rotate, and flip the image.","WI-021, WI-022","A custom WPF control is developed using Vortice.Windows for DirectX-based, GPU-accelerated rendering. The viewer supports monochrome/color images and VOI LUTs. A surrounding UI provides standard tools for zoom, pan, rotation, flip, and interactive window/level adjustments with common presets."
"US-012","DICOM Functionality","Annotate and Measure DICOM Images","Technician / Administrator","As a Technician, I want to draw annotations and perform measurements on images so that I can highlight findings and record key metrics.","Should Have",13,"US-011","Given an image is open in the viewer, When I select the length measurement tool and draw a line, Then the length is displayed on the image in millimeters (mm).","Given I have created several annotations and measurements, When I click 'Save Annotations', Then a new DICOM Grayscale Softcopy Presentation State (GSPS) object is created and saved with the study.","Given I re-open a study that has saved annotations, When the images are displayed, Then the previously saved annotations and measurements are automatically loaded and displayed on top of the images.","WI-023","The viewer is extended with tools for creating graphical annotations (arrows, text) and measurements (length, angle). Saving these annotations generates and stores a new DICOM GSPS object using fo-dicom, ensuring the original image files are never modified."
"US-013","Printing, PDF Export, and Emailing","Print DICOM Images with Custom Layouts","Technician / Administrator","As a Technician, I want to print DICOM images on a standard office printer with flexible layouts so that I can create hard copies for reference or sharing.","Must Have",13,"US-003, US-011","Given I have selected images for printing, When I open the Print Preview window, Then I can select a predefined layout (e.g., '2x2 grid on A4') and see a WYSIWYG preview.","Given I am in the Print Preview window, When I click the 'Print' button, Then the print job is submitted to a background queue, and my UI remains responsive.","Given a print job was submitted, When the background service processes the job, Then the final output is spooled to the selected Windows printer.","WI-024, WI-025, WI-026","A WPF Print Preview window is created for layout selection and configuration. Print jobs are submitted asynchronously to a RabbitMQ queue. A consumer in the Windows Service processes these jobs, generates the output, and spools it to a standard Windows printer."
"US-014","System Administration and Monitoring","Review System Audit Trail","Administrator","As an Administrator, I want to view a log of all significant system events so that I can perform security audits and investigate incidents.","Must Have",8,"US-005","Given several auditable actions have occurred (e.g., a user was created, a study was deleted), When I open the Audit Trail viewer in the Administration area, Then I can see a chronological list of all logged events.","Given the audit log is displayed, When I use the filter controls to select a specific user and date range, Then the list updates to show only the events matching my criteria.","Given I have filtered the audit log, When I click the 'Export to CSV' button, Then a CSV file containing the currently displayed log entries is generated and saved.","WI-031","A comprehensive auditing service is created to log events to a dedicated database table. An admin-only WPF view is developed to display, filter (by user/date), and export the audit trail to a CSV file. All audit log write operations are atomic with the action being audited."
"US-015","Printing, PDF Export, and Emailing","Export Print Layout to PDF","Technician / Administrator","As a Technician, I want to export my print layout as a secure PDF file so that I can create a digital, portable copy of the output.","Should Have",5,"US-013","Given I have arranged a layout in the Print Preview window, When I click 'Export to PDF', Then the export job is submitted to a background queue for processing.","Given I choose to export a PDF with a password, When I open the resulting PDF file, Then I am prompted to enter the password before the contents are visible.","Given I export a PDF, When the file is analyzed, Then it is compliant with the PDF/A-3 standard.","WI-027","The 'Export to PDF' feature is added to the Print Preview. It sends an asynchronous job to a RabbitMQ queue. A background consumer uses the QuestPDF library to generate a PDF/A-3 compliant file, with options for AES-256 password encryption."
"US-016","System Administration and Monitoring","Manage Remote PACS Configurations","Administrator","As an Administrator, I want to manage the configurations for remote PACS so that users can query and retrieve studies from our trusted external systems.","Must Have",5,"US-010","Given I am in the Administration area, When I open the PACS Configuration screen, Then I can add a new PACS by providing its AE Title, IP Address, and Port.","Given a PACS is configured in the list, When I click the 'Verify' button, Then the system sends a DICOM C-ECHO request to that PACS and displays a 'Success' or 'Failure' message.","Given I edit or delete a PACS configuration, When I save the changes, Then the updated configuration is persisted in the database.","WI-028","An admin-only WPF UI is created for full CRUD management of remote PACS configurations. A 'Verify' feature uses fo-dicom to perform a C-ECHO test. All configurations are stored in the `PacsConfiguration` database table."
"US-017","System Administration and Monitoring","Configure Automated Data Retention Policy","Administrator","As an Administrator, I want to configure an automated data retention policy so that old studies are purged from the system to manage storage and comply with data governance rules.","Should Have",5,"US-005, US-014","Given I am in the Administration area, When I navigate to the Data Retention settings, Then I can enable the policy and set the retention period in years (e.g., 7 years).","Given the auto-purge policy is enabled, When the scheduled background task runs, Then any study older than the configured retention period is permanently deleted from the database and file system.","Given the auto-purge task has deleted studies, When I review the audit trail, Then a log entry exists for each auto-purge action, detailing which studies were deleted and when.","WI-029","An admin UI is created to enable and configure the data retention period. A scheduled, hosted service in the Windows Service periodically runs to identify and delete data older than the policy specifies. All deletions are logged to the audit trail."
"US-018","System Administration and Monitoring","Monitor Real-Time System Health","Administrator","As an Administrator, I want to view a real-time health dashboard so that I can quickly assess the operational status of all critical system components.","Should Have",8,"US-003, US-005","Given I am in the Administration area, When I open the System Health Dashboard, Then I see status indicators for the Windows Service, PostgreSQL connectivity, and RabbitMQ connectivity.","Given the dashboard is open, When I view the queue metrics, Then I see the current number of messages in the main processing queue and the dead-letter queue.","Given the dashboard is open, When I look at the storage metric, Then I see the amount of available disk space at the configured DICOM storage location.","WI-030","A background service is implemented to periodically poll and cache the status of key components (DB, MQ, Disk). An admin-only WPF dashboard queries this status data via IPC and displays it with clear visual indicators (e.g., green/red lights, counters)."
"US-019","Deployment and Installation","Install the Application and Verify Prerequisites","System Administrator","As a System Administrator, I want a single installer package that guides me through the installation and verifies all prerequisites so that I can deploy the application correctly and reliably.","Must Have",13,"","Given I run the MSIX installer on a clean machine, When the installation prompts for configuration, Then I am asked to provide and test the connection details for PostgreSQL and RabbitMQ.","Given I provide incorrect database connection details during installation, When I try to proceed, Then the installation is blocked and an error message is displayed, preventing an incomplete setup.","Given I provide valid connection details to a PostgreSQL server where the `pgcrypto` extension is not enabled, When I test the connection, Then the prerequisite check fails and I am instructed to enable the extension.","WI-032, WI-033","An MSIX packaging project is created to bundle the client and service. A first-run configuration wizard is implemented that runs during installation. This wizard validates connectivity to PostgreSQL and RabbitMQ and verifies that the `pgcrypto` extension is enabled before allowing the installation to complete."
"US-020","Deployment and Installation","Automate the Application Build and Signing Process","Developer","As a Developer, I want an automated CI/CD pipeline so that every code change is consistently built, tested, and packaged into a signed installer, ensuring release quality.","Must Have",8,"US-019","Given I push a code change to the source control repository, When the CI/CD pipeline is triggered, Then it automatically builds the entire solution and runs all unit tests.","Given the build and unit tests succeed, When the pipeline continues, Then it creates the MSIX package and signs it with a secure code signing certificate.","Given the pipeline completes successfully, When I check the build artifacts, Then a signed, installable MSIX package is available for download and deployment.","WI-034","A CI/CD pipeline is created using a tool like GitHub Actions or Azure DevOps. The pipeline is configured to build the .NET solution, execute the xUnit test suite, and, upon success, run the packaging and signing steps to produce the final MSIX installer as an artifact."