"story_id","epic","title","user_role","description","business_value","priority","story_points","dependencies","acceptance_criteria","technical_tasks","definition_of_done"
"US-001","User Authentication & Authorization","Securely Log In to the Application","Registered System User (Technician or Administrator)","As a Registered System User, I want to securely log in to the application using my unique username and password so that I can gain access to the system and use the features authorized for my specific role.","Ensures that only authorized personnel can access sensitive Protected Health Information (PHI), enforcing security, meeting HIPAA compliance, and enabling the role-based access control model which is fundamental to the system's operation.","Must Have","8","[""US-002"",""US-003""]","[{""scenario"":""Successful login with valid credentials"",""given"":""I have a valid and active account in the system"",""when"":""I enter my correct username and password and click 'Login'"",""then"":""the login window closes, and the main application window is displayed with features corresponding to my assigned role.""},{""scenario"":""Login attempt with incorrect password"",""given"":""I have a valid account"",""when"":""I enter my correct username but an incorrect password"",""then"":""a non-specific error message 'Invalid username or password.' is displayed, and I remain on the login screen.""},{""scenario"":""Login attempt with a disabled account"",""given"":""my user account has been disabled by an administrator"",""when"":""I enter my correct username and password"",""then"":""a specific error message 'Your account has been disabled. Please contact an administrator.' is displayed, and I am prevented from logging in.""}]","[""WI-012: Implement Login View and ViewModel"",""WI-013: Implement Authentication Service"",""WI-009: Implement BCrypt Password Hashing""]","[""All acceptance criteria are met and validated."",""Code is peer-reviewed and merged into the main branch."",""Unit and integration tests for the authentication service and ViewModel achieve >80% code coverage."",""A security review of the password handling and authentication logic is completed."",""E2E tests for successful and failed login scenarios are passing.""]"
"US-002","User Authentication & Authorization","Create and Manage User Accounts","Administrator","As an Administrator, I want to create, view, edit, and delete user accounts so that I can manage system access for all personnel in accordance with their roles and responsibilities.","Enables secure and efficient onboarding, offboarding, and role management of system users, which is a fundamental requirement for operational readiness and security compliance.","Must Have","13","[""US-001"",""US-003"",""US-018""]","[{""scenario"":""Administrator creates a new Technician user"",""given"":""I am logged in as an Administrator and on the User Management page"",""when"":""I provide a unique username, select the 'Technician' role, and confirm creation"",""then"":""a new user is created with a secure temporary password, the user is flagged to require a password change on next login, and the new user appears in the user list.""},{""scenario"":""Administrator edits a user's role"",""given"":""I am logged in as an Administrator"",""when"":""I select a 'Technician' user and change their role to 'Administrator'"",""then"":""the user's permissions are updated, and the change is recorded in the audit trail.""},{""scenario"":""Administrator attempts to delete the last administrator account"",""given"":""there is only one active Administrator account in the system"",""when"":""I attempt to delete that account"",""then"":""the system prevents the action and displays an error message stating that at least one administrator is required.""},{""scenario"":""Administrator cannot edit or delete their own account"",""given"":""I am logged in as an Administrator"",""when"":""I view my own account in the user list"",""then"":""the 'Edit' and 'Delete' controls are disabled.""}]","[""WI-008: Define User, Role, and PasswordHistory Entities"",""WI-045: Create User Management View"",""WI-046: Implement 'Add User' and 'Edit User' Logic""]","[""All acceptance criteria are met."",""User CRUD operations are fully functional and audited."",""Business rules (last admin, self-edit) are enforced."",""Unit tests for the UserService business logic are implemented."",""E2E tests for creating, editing, and deleting a user are passing.""]"
"US-003","Auditing & Compliance","Establish Comprehensive Audit Trail","Administrator","As an Administrator, I want the system to automatically record all significant security and data modification events in a central audit trail so that I can review user activity for compliance and security investigations.","Provides essential traceability for all actions involving PHI and system configuration, which is critical for security incident response, accountability, and meeting HIPAA regulatory requirements.","Must Have","8","[]","[{""scenario"":""An auditable event occurs"",""given"":""the audit service is running"",""when"":""an Administrator resets a user's password"",""then"":""a new entry is created in the audit log table containing the administrator's ID, the event type 'Password Reset', the target user's ID, and a timestamp.""},{""scenario"":""Administrator views the audit trail"",""given"":""I am logged in as an Administrator"",""when"":""I navigate to the Audit Trail viewer"",""then"":""I can see a list of all recorded audit events and filter them by user and date range.""},{""scenario"":""Administrator exports the audit trail"",""given"":""I have filtered the audit trail view"",""when"":""I click the 'Export to CSV' button"",""then"":""a CSV file containing the currently displayed audit logs is generated and downloaded.""}]","[""WI-050: Design and Implement AuditLog Entity and Service"",""WI-051: Integrate Auditing into All Required Workflows"",""WI-053: Implement Audit Trail Viewer""]","[""All acceptance criteria are met."",""The AuditLog entity and service are implemented."",""Key workflows (user management, metadata edits) correctly create audit log entries."",""The Audit Trail viewer is functional, including filtering and exporting."",""Integration tests verify that audited actions create the correct log entries.""]"
"US-004","User Authentication & Authorization","Apply Role-Based Access Control (RBAC)","System User (Technician or Administrator)","As a System User, I want the application's features and UI controls to be enabled or disabled based on my assigned role so that I can only perform authorized actions, ensuring system security.","Enforces the principle of least privilege, a core HIPAA security requirement, by preventing unauthorized access to sensitive data and system configurations, reducing the risk of data breaches and operational errors.","Must Have","5","[""US-001""]","[{""scenario"":""Technician logs in and sees a restricted UI"",""given"":""I am logged in with a 'Technician' role"",""when"":""I navigate the application"",""then"":""the 'Administration' area is hidden, and the 'Edit DICOM Metadata' button is disabled.""},{""scenario"":""Administrator logs in and has full access"",""given"":""I am logged in with an 'Administrator' role"",""when"":""I navigate the application"",""then"":""all features, including the 'Administration' area and 'Edit DICOM Metadata' button, are visible and enabled.""},{""scenario"":""Backend prevents unauthorized action"",""given"":""I am authenticated as a 'Technician'"",""when"":""I attempt to invoke an administrative function programmatically, bypassing the UI"",""then"":""the action is rejected by the backend with an authorization error.""}]","[""WI-014: Implement Role-Based UI Control""]","[""All acceptance criteria are met."",""UI controls are correctly shown/hidden/disabled based on the logged-in user's role."",""Backend services enforce authorization checks for sensitive operations."",""E2E tests validate the UI state and accessibility for both Technician and Admin roles.""]"
"US-005","User Authentication & Authorization","Automatically Lock Session After Inactivity","System User","As a System User, I want the application to automatically lock itself after 15 minutes of inactivity so that sensitive PHI is protected from unauthorized viewing on an unattended workstation.","Enhances security and ensures HIPAA compliance by automatically securing sessions on unattended workstations, mitigating the risk of unauthorized PHI access and potential data breaches.","Must Have","8","[""US-001""]","[{""scenario"":""Session locks after inactivity"",""given"":""I am logged into the application"",""when"":""I perform no keyboard or mouse actions for 15 minutes"",""then"":""a modal lock screen overlay is displayed, obscuring the entire application and prompting for my password.""},{""scenario"":""Inactivity timer resets on user interaction"",""given"":""I have been inactive for 14 minutes"",""when"":""I move the mouse or press a key"",""then"":""the 15-minute inactivity timer is reset, and the session remains active.""},{""scenario"":""User successfully unlocks the session"",""given"":""my session is locked"",""when"":""I enter my correct password and click 'Unlock'"",""then"":""the lock screen is removed, and the application is restored to its exact pre-lock state.""}]","[""WI-015: Implement Automatic Session Lock Feature""]","[""All acceptance criteria are met."",""The inactivity monitor correctly triggers the lock screen."",""The lock screen preserves and restores the application state upon successful unlock."",""The performance impact of the inactivity hook is verified to be negligible."",""The feature is validated by security review to be non-bypassable.""]"
"US-006","DICOM Core Functionality","Asynchronously Receive and Store DICOM Studies","System","As the System, I want to function as a DICOM C-STORE SCP, reliably receiving studies from external modalities and persisting their metadata and files without impacting performance so that we can act as a central node in a clinical workflow.","Provides the core clinical data ingestion capability, enabling the system to interoperate with imaging modalities (like CT, MRI scanners) and other PACS, which is essential for its primary function.","Must Have","13","[""US-023""]","[{""scenario"":""A modality sends a study to the system"",""given"":""the background service is running and listening on its DICOM port"",""when"":""an external DICOM SCU sends a study via a C-STORE operation"",""then"":""the SCP accepts the association, saves the files, and immediately publishes a message to RabbitMQ with the study metadata, then sends a success response to the SCU.""},{""scenario"":""The system processes a received study from the queue"",""given"":""a message for a new study is in the RabbitMQ queue"",""when"":""the persistence consumer processes the message"",""then"":""new records for the Patient, Study, Series, and Images are created in the PostgreSQL database, the DICOM files are moved to the permanent hierarchical storage location, and the message is acknowledged from the queue.""},{""scenario"":""A processing failure routes a message to the Dead-Letter Queue"",""given"":""a message in the queue contains malformed data causing a persistent database error"",""when"":""the consumer fails to process the message a configurable number of times"",""then"":""the message is rejected without requeueing and is automatically routed to the Dead-Letter Queue (DLQ) for manual inspection.""}]","[""WI-003: Implement RabbitMQ Publisher and Consumer Abstractions"",""WI-004: Implement RabbitMQ Dead-Letter Exchange (DLX) Mechanism"",""WI-018: Implement DICOM C-STORE SCP Listener"",""WI-022: Develop DICOM Metadata Persistence Consumer"",""WI-023: Implement Hierarchical File Storage Logic""]","[""All acceptance criteria are met."",""The system can successfully receive and persist studies from a test SCU tool (e.g., `dcmtk`)."",""The decoupling of SCP reception and database persistence via RabbitMQ is fully implemented."",""The DLQ mechanism is tested and verified to work correctly on processing failure."",""The C-STORE SCP can handle at least 10 simultaneous associations without performance degradation.""]"
"US-007","DICOM Core Functionality","Query and Retrieve Studies from a Remote PACS","Technician","As a Technician, I want to query a configured remote PACS for studies and retrieve selected studies to my local system so that I can perform viewing, printing, or other operations on them.","Enables seamless integration with existing hospital-wide PACS, allowing users to pull necessary prior studies or current exams into the local application for their specific workflow, enhancing clinical efficiency.","Must Have","8","[""US-006"",""US-008""]","[{""scenario"":""User successfully queries a remote PACS"",""given"":""I am on the 'Query/Retrieve' page and a remote PACS is correctly configured"",""when"":""I enter search criteria (e.g., Patient ID) and click 'Search'"",""then"":""the system performs a DICOM C-FIND, and a list of matching studies from the remote PACS is displayed in the UI.""},{""scenario"":""User successfully retrieves a study from a remote PACS"",""given"":""I have a list of search results from a remote PACS"",""when"":""I select a study from the results and click 'Retrieve'"",""then"":""the system initiates a DICOM C-MOVE, the remote PACS sends the study to our system's SCP, and the UI provides real-time feedback on the retrieval progress and completion.""},{""scenario"":""Query or retrieve operation fails"",""given"":""the remote PACS is offline or the configuration is incorrect"",""when"":""I attempt to search or retrieve a study"",""then"":""the system times out or fails gracefully and displays a descriptive error message to me in the UI.""}]","[""WI-019: Implement DICOM C-FIND SCU"",""WI-020: Implement DICOM C-MOVE SCU""]","[""All acceptance criteria are met."",""The user can perform a C-FIND against a test PACS and view results."",""The user can initiate a C-MOVE, and the study is successfully received by the local C-STORE SCP."",""All network operations are asynchronous and do not block the UI."",""UI provides clear feedback on the status of the operations.""]"
"US-008","System Administration & Configuration","Manage Remote PACS Connections","Administrator","As an Administrator, I want to add, edit, remove, and verify remote PACS configurations so that I can manage the systems our application integrates with for query/retrieve functions.","Provides the necessary administrative control to configure and maintain critical integrations with external clinical systems, ensuring the query/retrieve functionality remains operational and accurate.","Should Have","5","[]","[{""scenario"":""Administrator adds a new PACS configuration"",""given"":""I am on the PACS Configuration page"",""when"":""I enter the AE Title, IP Address, and Port for a new PACS and click 'Save'"",""then"":""the new PACS configuration is saved to the database and appears in the list of configured PACS.""},{""scenario"":""Administrator verifies a PACS connection"",""given"":""a PACS is configured in the system"",""when"":""I click the 'Verify' button for that PACS"",""then"":""the system sends a DICOM C-ECHO request to the PACS and displays a 'Success' or 'Failure' message based on the response.""}]","[""WI-021: Implement DICOM C-ECHO SCU"",""WI-048: Implement PACS Configuration Management UI""]","[""All acceptance criteria are met."",""Full CRUD functionality for PACS configurations is implemented."",""The C-ECHO verification provides immediate and accurate feedback."",""The UI is restricted to Administrator roles.""]"
"US-009","Advanced DICOM Viewer & Tools","View and Manipulate DICOM Images","Technician","As a Technician, I want a high-performance DICOM viewer with a standard set of image manipulation tools so that I can efficiently review and analyze clinical images.","Provides the core clinical image review capability. A fast, intuitive viewer with essential tools directly improves diagnostic efficiency and user satisfaction.","Must Have","13","[]","[{""scenario"":""User opens a large study"",""given"":""I have a multi-frame CT study"",""when"":""I open the study in the viewer"",""then"":""a low-resolution preview appears almost instantly, followed by the full-resolution image, and the UI remains responsive throughout.""},{""scenario"":""User uses image manipulation tools"",""given"":""an image is open in the viewer"",""when"":""I use my mouse to zoom, pan, and adjust the window/level (WW/WL)"",""then"":""the image updates in real-time with smooth, interactive feedback, and I can apply common WW/WL presets like 'Lung' or 'Bone'.""},{""scenario"":""User uses comparison mode"",""given"":""I have two related series open"",""when"":""I activate the side-by-side comparison mode with synchronization enabled"",""then"":""I can view both series simultaneously, and actions like panning and zooming are mirrored across both viewports.""}]","[""WI-024: Set up DirectX Rendering in WPF using Vortice.Windows"",""WI-025: Implement DICOM Pixel Data to GPU Texture Upload"",""WI-026: Implement Progressive Loading Strategy"",""WI-027: Implement Zoom, Pan, and Rotate Tools"",""WI-028: Implement Interactive Window/Level (WW/WL)"",""WI-031: Implement Side-by-Side Comparison Mode"",""WI-032: Implement Thumbnail Grid Panel""]","[""All acceptance criteria are met."",""The viewer is GPU-accelerated and renders images correctly."",""Progressive loading is functional and improves perceived performance."",""All standard manipulation tools (Zoom, Pan, WW/WL, Rotate, Flip) are implemented and intuitive to use."",""Side-by-side mode with synchronization is working.""]"
"US-010","Advanced DICOM Viewer & Tools","Create and Save Non-Destructive Annotations","Technician","As a Technician, I want to create non-destructive annotations and measurements on images and save them for later review so that I can highlight findings and record key metrics.","Enhances the clinical utility of the viewer by allowing users to add their own interpretative data to images. Saving these as standard DICOM Presentation States ensures interoperability and preserves the integrity of the original images.","Should Have","13","[""US-009""]","[{""scenario"":""User creates a measurement"",""given"":""an image with known pixel spacing is open in the viewer"",""when"":""I use the length measurement tool to draw a line on a feature"",""then"":""the length of the line is displayed in real-world units (e.g., millimeters).""},{""scenario"":""User saves annotations"",""given"":""I have added several annotations (arrows, text, measurements) to a series"",""when"":""I save my work"",""then"":""the system creates a new DICOM Grayscale Softcopy Presentation State (GSPS) object associated with the original series.""},{""scenario"":""User re-opens a study with saved annotations"",""given"":""a study has a saved GSPS object"",""when"":""I open the study"",""then"":""the application automatically detects and applies the GSPS, displaying my previously saved annotations on the correct images.""}]","[""WI-029: Implement Annotation and Measurement Tools"",""WI-030: Implement Saving Annotations as DICOM GSPS""]","[""All acceptance criteria are met."",""Users can create annotations (arrows, text) and measurements (length, angle, area)."",""Annotations are successfully saved by creating a valid DICOM GSPS object."",""The system correctly loads and displays annotations from an existing GSPS object.""]"
"US-011","Printing & Exporting","Prepare and Submit a Print Job","Technician","As a Technician, I want a rich print preview interface to arrange images, select layouts, and configure options so that I can submit a print job for asynchronous background processing.","Provides an essential output function, allowing users to create physical copies of images. The asynchronous submission ensures the user interface remains responsive and is not blocked by slow printing operations.","Must Have","8","[""US-012"",""US-023""]","[{""scenario"":""User configures a print layout"",""given"":""I am in the Print Preview window with several images selected"",""when"":""I select a '2x2 grid on A4' layout, change the orientation to 'Landscape', and drag-and-drop images to rearrange their order"",""then"":""the preview on screen accurately reflects my chosen layout and configuration.""},{""scenario"":""User submits a print job successfully"",""given"":""I have configured my print layout and the background service is running"",""when"":""I select a printer and click 'Print'"",""then"":""the system checks that the service is available, creates a 'Queued' job record in the database, publishes the job to the RabbitMQ print queue, and shows me a non-blocking notification that my job has been submitted.""},{""scenario"":""User attempts to print while the background service is unavailable"",""given"":""the background 'DICOM Service' is stopped"",""when"":""I open the Print Preview window"",""then"":""the 'Print' button is disabled, and a notification informs me that the print service is unavailable.""}]","[""WI-038: Build Print Preview View and ViewModel"",""WI-039: Implement Drag-and-Drop Image Rearrangement"",""WI-040: Implement Print Job Submission Logic"",""WI-005: Implement Named Pipes for Synchronous Status Checks""]","[""All acceptance criteria are met."",""The print preview UI allows for full configuration of layouts and options."",""Drag-and-drop image rearrangement is functional."",""Job submission correctly uses Named Pipes for status check and RabbitMQ for queuing."",""UI provides clear feedback when the print service is down.""]"
"US-012","Printing & Exporting","Monitor and Manage Print Jobs","System User","As a System User, I want to view a print queue with the status of all submitted jobs so that I can track my prints, cancel them if needed, and retry failed jobs.","Provides users with visibility and control over background printing tasks, improving user experience and reducing waste by allowing cancellation of unwanted jobs and recovery from transient printer errors.","Should Have","5","[""US-011""]","[{""scenario"":""Technician views and cancels their own job"",""given"":""I am a Technician and I have submitted a print job that is still in the 'Queued' state"",""when"":""I navigate to the Print Queue viewer"",""then"":""I can see my job in the list and I am able to cancel it.""},{""scenario"":""Administrator manages the entire print queue"",""given"":""I am an Administrator"",""when"":""I navigate to the Print Queue viewer"",""then"":""I can see all jobs submitted by all users and have the ability to cancel any job or re-prioritize 'Queued' jobs.""},{""scenario"":""User retries a failed job"",""given"":""my print job has a status of 'Failed' with a reason 'Printer is offline'"",""when"":""I click the 'Retry' button for that job"",""then"":""the system re-submits the job to the print queue.""}]","[""WI-034: Create PrintJob Entity and Repository"",""WI-035: Implement Print Job Consumer Service"",""WI-036: Integrate QuestPDF for Document Generation"",""WI-037: Integrate with Windows Print API"",""WI-041: Implement Print Queue Viewer""]","[""All acceptance criteria are met."",""The print job consumer correctly processes jobs and updates their status in the database."",""The Print Queue UI displays jobs and statuses accurately."",""Role-based controls for canceling and re-prioritizing jobs are correctly implemented.""]"
"US-013","Printing & Exporting","Export Print Layout as a Secure PDF","Technician","As a Technician, I want to export my configured print layout as a password-protected, standards-compliant PDF/A file so that I can create a secure, portable digital document for sharing or archiving.","Provides a critical digital output format that supports secure electronic sharing and long-term archival standards (PDF/A), enhancing interoperability and compliance.","Should Have","5","[""US-011""]","[{""scenario"":""User exports a layout to a password-protected PDF"",""given"":""I have a configured print layout in the Print Preview window"",""when"":""I click 'Export to PDF', provide a file name, enter a password, and confirm"",""then"":""the system asynchronously generates a PDF file that is encrypted with AES-256 and requires the password to open.""},{""scenario"":""User exports a layout to a PDF/A-3 compliant file"",""given"":""I have a configured print layout"",""when"":""I click 'Export to PDF'"",""then"":""the generated PDF file is compliant with the PDF/A-3 standard.""}]","[""WI-042: Implement Export to PDF/A-3""]","[""All acceptance criteria are met."",""The export is processed asynchronously by the background service."",""The output file is a valid PDF/A-3 document, verified by a compliance checker."",""The password encryption option correctly produces an AES-256 encrypted PDF.""]"
"US-014","Data Management & Anonymization","Safely Edit DICOM Metadata","Administrator","As an Administrator, I want to edit specific DICOM metadata tags in a study without altering the original files so that I can correct errors while maintaining data integrity and a complete audit trail.","Allows for the correction of critical patient or study metadata errors in a secure, non-destructive, and auditable manner. This is vital for data accuracy and maintaining the integrity of the original source images.","Should Have","8","[""US-003""]","[{""scenario"":""Administrator initiates a metadata edit"",""given"":""I am an Administrator viewing a study's metadata"",""when"":""I click the 'Edit Metadata' button"",""then"":""the system creates a 'working copy' of all files in the study, and the action 'Working Copy Created' is logged in the audit trail.""},{""scenario"":""Administrator edits and saves a tag value"",""given"":""I am in a metadata edit session"",""when"":""I change the 'Patient's Name' tag and click 'Save'"",""then"":""the change is saved to the working copy file, and a detailed audit log entry is created including my user ID, the tag changed, its original value, and its new value.""},{""scenario"":""User re-opens a study with unsaved edits"",""given"":""an Administrator previously started an edit session for a study but closed the application without saving"",""when"":""any user opens that same study"",""then"":""a dialog prompts me to either 'Continue with unsaved changes' (loading the working copy) or 'Discard changes' (deleting the working copy).""}]","[""WI-054: Implement DICOM Tag Viewer"",""WI-055: Implement 'Working Copy' on Edit"",""WI-056: Implement 'Working Copy' Persistence"",""WI-057: Implement DICOM Tag Editor UI""]","[""All acceptance criteria are met."",""The 'working copy' mechanism is fully implemented and ensures original files are never modified by edits."",""All metadata edits are comprehensively logged in the audit trail."",""The persistence of unsaved working copies functions correctly.""]"
"US-015","Data Management & Anonymization","Anonymize DICOM Studies for Research or Sharing","Technician","As a Technician, I want to create a de-identified copy of a study by removing or altering metadata and burning in pixel masks so that I can safely use the data for research, teaching, or sharing without exposing PHI.","Enables compliance with HIPAA privacy rules for secondary uses of clinical data. This feature is critical for supporting research, education, and quality assurance activities by providing a secure way to de-identify PHI.","Should Have","8","[]","[{""scenario"":""User anonymizes metadata using a standard profile"",""given"":""I have selected a study to anonymize"",""when"":""I choose the 'HIPAA Safe Harbor' anonymization profile and execute the action"",""then"":""the system creates a new copy of the study with all 18 HIPAA-specified identifiers removed from the DICOM metadata, and the original study remains unmodified.""},{""scenario"":""User applies a pixel-level blackout mask"",""given"":""I have an image with visible text containing PHI"",""when"":""I draw a blackout rectangle over the text and execute the pixel anonymization action"",""then"":""the system creates a new series containing a new version of the image with the rectangle permanently burned into the pixel data, and the original series remains untouched.""}]","[""WI-058: Implement Metadata Anonymization Engine"",""WI-059: Implement Pixel Anonymization (Burn-in)""]","[""All acceptance criteria are met."",""Metadata anonymization correctly removes tags according to the selected profile."",""Pixel anonymization correctly burns masks into image data."",""All anonymization actions are non-destructive and create new copies of the data, leaving the originals intact.""]"
"US-016","External Integrations & Deployment","Validate Application License on Startup","System","As the System, I want to validate my license with the external Odoo API on startup and gracefully handle failures or invalid licenses so that I can enforce commercial terms and protect intellectual property.","Enables the commercial licensing model for the software. The grace period and read-only mode provide a fair and robust mechanism to handle network issues while ensuring compliance with licensing terms.","Must Have","5","[]","[{""scenario"":""Application starts with a valid license and network connectivity"",""given"":""the license key is valid and the Odoo API is reachable"",""when"":""the application starts"",""then"":""the license is validated successfully, and the application enters its fully functional mode.""},{""scenario"":""Application starts without network connectivity"",""given"":""the Odoo API is unreachable"",""when"":""the application starts"",""then"":""it enters a fully functional 72-hour grace period.""},{""scenario"":""Grace period expires or license is invalid"",""given"":""the 72-hour grace period has expired without a successful validation, or the API returns an invalid license status"",""when"":""the application starts or the check occurs"",""then"":""the application enters a restricted, read-only mode where functions like printing, exporting, and receiving new studies are disabled.""}]","[""WI-060: Implement Odoo REST API Client"",""WI-061: Implement License Validation Workflow""]","[""All acceptance criteria are met."",""The Odoo API client is implemented and handles success and error cases."",""The state machine logic for 'Licensed', 'Grace Period', and 'Read-Only' modes is fully functional."",""Communication with the Odoo API is secured using at least TLS 1.2.""]"
"US-017","External Integrations & Deployment","Install and Configure the Application","Administrator","As an Administrator, I want to install the application using a standard MSIX installer and be guided through the initial configuration of database and message queue connections so that I can deploy the system successfully.","Provides a professional, reliable, and straightforward installation and setup experience, reducing deployment friction and support costs. The prerequisite check prevents runtime errors due to misconfiguration.","Must Have","8","[]","[{""scenario"":""Administrator installs the application"",""given"":""I have the signed MSIX installer package"",""when"":""I run the installer on a supported Windows machine"",""then"":""the application is successfully installed.""},{""scenario"":""Administrator runs the application for the first time"",""given"":""the application has just been installed"",""when"":""I launch the application"",""then"":""I am presented with a first-run configuration dialog prompting for PostgreSQL and RabbitMQ connection details.""},{""scenario"":""Configuration check fails"",""given"":""I am in the first-run configuration dialog"",""when"":""I enter incorrect PostgreSQL connection details and try to proceed"",""then"":""the system displays a connection error, and I am not allowed to complete the setup until a valid connection is established.""},{""scenario"":""PostgreSQL is missing the required extension"",""given"":""I have provided valid PostgreSQL connection details, but the database is missing the 'pgcrypto' extension"",""when"":""the system validates the connection"",""then"":""it displays a specific error message stating that the 'pgcrypto' extension is required, and I cannot proceed.""}]","[""WI-062: Create and Configure MSIX Packaging Project"",""WI-063: Implement Installer Prerequisite Check""]","[""All acceptance criteria are met."",""A signed MSIX package can be successfully built."",""The installed application launches into a mandatory first-run configuration wizard."",""The wizard correctly validates connectivity to both PostgreSQL and RabbitMQ, including the `pgcrypto` check.""]"
"US-018","System Monitoring & Reliability","Monitor System Health via a Dashboard","Administrator","As an Administrator, I want to view a System Health Dashboard that displays the real-time status of critical components so that I can proactively monitor the system's operational health and quickly identify issues.","Provides crucial visibility into the system's operational status, enabling proactive maintenance, faster troubleshooting, and improved uptime. This reduces the risk of service interruptions affecting clinical workflows.","Should Have","8","[""US-019""]","[{""scenario"":""Administrator views the health dashboard when all systems are normal"",""given"":""I am an Administrator and all system components are running correctly"",""when"":""I navigate to the System Health Dashboard"",""then"":""I see 'Running' or 'Connected' status indicators for the Windows Service, PostgreSQL, and RabbitMQ, and the message queue counts are at or near zero.""},{""scenario"":""A component fails and the dashboard reflects the change"",""given"":""the PostgreSQL database server is shut down"",""when"":""I view the System Health Dashboard"",""then"":""the indicator for PostgreSQL connectivity shows a 'Disconnected' or 'Error' status.""},{""scenario"":""The dashboard warns about low disk space"",""given"":""the available disk space at the DICOM storage location is below the configured warning threshold"",""when"":""I view the System Health Dashboard"",""then"":""the disk space indicator is shown in a warning color (e.g., yellow or red).""}]","[""WI-064: Implement System Health Probe Service"",""WI-065: Develop System Health Dashboard UI""]","[""All acceptance criteria are met."",""A background service correctly polls and caches the status of all required components (Service, DB, MQ, Disk Space, Queue Depths)."",""The dashboard UI accurately displays the cached status with clear visual indicators."",""The UI is restricted to Administrator roles.""]"
"US-019","System Monitoring & Reliability","Receive Automated Alerts for Critical System Errors","Administrator","As an Administrator, I want the system to automatically send me an email alert when a critical error occurs or a health metric crosses a critical threshold so that I can be notified of problems immediately without constantly monitoring the dashboard.","Enables a proactive operational support model, reducing the Mean Time To Detection (MTTD) for critical failures. This allows for faster response and resolution, minimizing system downtime and impact on users.","Could Have","5","[""US-018""]","[{""scenario"":""A message lands in the Dead-Letter Queue"",""given"":""I have configured a recipient email address for alerts"",""when"":""a message fails processing and is routed to the DLQ"",""then"":""the system automatically sends an alert email to my configured address notifying me of the poison message.""},{""scenario"":""Disk space becomes critically low"",""given"":""I have configured an alert email address"",""when"":""the available disk space drops below the configured critical threshold"",""then"":""the system automatically sends a critical alert email to my address.""}]","[""WI-043: Implement SMTP Email Service"",""WI-066: Implement Critical Error Alerting""]","[""All acceptance criteria are met."",""Administrators can configure an alert recipient email address."",""The system correctly sends email alerts when specified critical thresholds (DLQ count, disk space) are breached.""]"
"US-020","Core Architecture & Technology Foundation","Ensure Background Service Reliability","System Operator","As a System Operator, I want the background Windows Service to be configured for automatic recovery so that it can restart itself after an unexpected crash, maximizing uptime and ensuring continuous processing of asynchronous tasks.","Increases system resilience and availability by automatically recovering from transient failures, reducing the need for manual intervention and ensuring that critical background tasks like DICOM ingestion and printing continue to be processed.","Must Have","1","[]","[{""scenario"":""The service process terminates unexpectedly"",""given"":""the 'DICOM Service' is installed and running"",""when"":""I forcefully terminate the service's process using Task Manager"",""then"":""the Windows Service Control Manager automatically restarts the service.""},{""scenario"":""Verify service recovery settings after installation"",""given"":""the service has been installed"",""when"":""I inspect the service's properties in the Windows 'Services' management console (`services.msc`)"",""then"":""the 'Recovery' tab shows that the 'First failure', 'Second failure', and 'Subsequent failures' actions are all set to 'Restart the Service'.""}]","[""WI-001: Create Windows Service Project using Generic Host"",""WI-002: Implement Automatic Service Recovery""]","[""All acceptance criteria are met."",""The deployment script or installer correctly configures the service recovery options."",""The automatic restart behavior is verified through testing.""]"
"US-021","Core Architecture & Technology Foundation","Personalize the Application Appearance","System User","As a System User, I want to switch between Light and Dark themes and enable a high-contrast mode so that I can adjust the application's appearance for my comfort and accessibility needs.","Improves user satisfaction and meets modern application standards by providing personalization options. The high-contrast mode is crucial for accessibility, ensuring the application is usable by individuals with visual impairments.","Should Have","2","[]","[{""scenario"":""User switches to Dark theme"",""given"":""the application is running in the default Light theme"",""when"":""I click the theme toggle switch"",""then"":""the entire application UI immediately changes to the Dark theme.""},{""scenario"":""User enables high-contrast mode"",""given"":""the application is in a standard theme"",""when"":""I select the high-contrast mode option"",""then"":""the application UI changes to a theme designed to meet WCAG 2.1 AA accessibility standards.""}]","[""WI-006: Scaffold WPF Project with MVVM and DI"",""WI-007: Integrate Material Design in XAML Toolkit""]","[""All acceptance criteria are met."",""Theme switching is functional and applies globally across the application."",""A high-contrast theme is available and meets accessibility guidelines.""]"
"US-022","Auditing & Compliance","Ensure PHI is Redacted from System Logs","Security Officer","As a Security Officer, I want to ensure that any Protected Health Information (PHI) is masked or redacted from general-purpose system logs (like text files or the Windows Event Log) so that we prevent accidental PHI exposure during troubleshooting and maintain HIPAA compliance.","A critical security control that reduces the risk of inadvertent PHI disclosure through log files. This simplifies log management and analysis by allowing logs to be shared with support personnel without containing sensitive data.","Must Have","5","[]","[{""scenario"":""Application logs an event containing PHI"",""given"":""the logging system is configured for PHI redaction"",""when"":""an action is performed that logs a message containing a patient's name, for example: 'Processing study for patient John Doe (ID: 12345)'"",""then"":""the resulting log entry in the text file and Windows Event Log appears as: 'Processing study for patient [REDACTED] (ID: [REDACTED])'.""}]","[""WI-052: Implement Serilog with PHI Redaction""]","[""All acceptance criteria are met."",""A custom Serilog component for PHI redaction is implemented and active."",""Unit tests verify that the redaction logic correctly identifies and masks various forms of PHI."",""Manual inspection of log files confirms that no PHI is present in plaintext.""]"
"US-023","Core Architecture & Technology Foundation","Securely Store Application Secrets","System Operator","As a System Operator, I want the application to store all sensitive credentials like database passwords and API keys securely using the Windows Credential Manager, not in plaintext configuration files, so that we can protect the system from credential theft.","Drastically improves the security posture of the application by adhering to the best practice of never storing secrets in code or configuration files. This prevents credentials from being exposed in source control or on the file system.","Must Have","3","[]","[{""scenario"":""Application retrieves database password at runtime"",""given"":""the database password has been stored in the Windows Credential Manager under the service account"",""when"":""the background service starts up and needs to connect to PostgreSQL"",""then"":""it successfully retrieves the password from the Credential Manager and establishes a connection.""},{""scenario"":""Configuration files do not contain secrets"",""given"":""I am inspecting the deployed application files"",""when"":""I view the contents of `appsettings.json` and other configuration files"",""then"":""I find no plaintext passwords, API keys, or other sensitive credentials.""}]","[""WI-011: Implement Secure Credential Storage""]","[""All acceptance criteria are met."",""A service for interacting with the Windows Credential Manager is implemented."",""All parts of the application that require secrets use this service."",""A review of all configuration files confirms the absence of plaintext secrets.""]"